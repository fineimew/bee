<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta http-equiv="X-UA-Compatible" content="IE=edge"/><title>OPQ View · Open Power Quality</title><meta name="viewport" content="width=device-width"/><meta name="generator" content="Docusaurus"/><meta name="description" content="OPQ View is a web application that provides visualization, notification, and user management services."/><meta name="docsearch:language" content="en"/><meta property="og:title" content="OPQ View · Open Power Quality"/><meta property="og:type" content="website"/><meta property="og:url" content="https://openpowerquality.org/index.html"/><meta property="og:description" content="OPQ View is a web application that provides visualization, notification, and user management services."/><meta name="twitter:card" content="summary"/><link rel="shortcut icon" href="/img/opq.ico"/><link rel="stylesheet" href="https://cdn.jsdelivr.net/docsearch.js/1/docsearch.min.css"/><link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/default.min.css"/><link rel="alternate" type="application/atom+xml" href="https://openpowerquality.org/blog/atom.xml" title="Open Power Quality Blog ATOM Feed"/><link rel="alternate" type="application/rss+xml" href="https://openpowerquality.org/blog/feed.xml" title="Open Power Quality Blog RSS Feed"/><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Gugi"/><script type="text/javascript" src="https://buttons.github.io/buttons.js"></script><script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.4/MathJax.js?config=TeX-MML-AM_CHTML"></script><script type="text/javascript" src="/js/mathjax-config.js"></script><script src="/js/scrollSpy.js"></script><link rel="stylesheet" href="/css/main.css"/><script src="/js/codetabs.js"></script></head><body class="sideNavVisible separateOnPageNav"><div class="fixedHeaderContainer"><div class="headerWrapper wrapper"><header><a href="/"><img class="logo" src="/img/opqlogo_white.png" alt="Open Power Quality"/><h2 class="headerTitleWithLogo">Open Power Quality</h2></a><div class="navigationWrapper navigationSlider"><nav class="slidingNav"><ul class="nav-site nav-site-internal"><li class="siteNavGroupActive"><a href="/docs/intro-motivation.html" target="_self">Documentation</a></li><li class="siteNavGroupActive"><a href="/docs/other-opportunities.html" target="_self">Opportunities</a></li><li class=""><a href="/blog/" target="_self">News</a></li><li class="navSearchWrapper reactNavSearchWrapper"><input type="text" id="search_input_react" placeholder="Search" title="Search"/></li></ul></nav></div></header></div></div><div class="navPusher"><div class="docMainWrapper wrapper"><div class="docsNavContainer" id="docsNav"><nav class="toc"><div class="toggleNav"><section class="navWrapper wrapper"><div class="navBreadcrumb wrapper"><div class="navToggle" id="navToggler"><div class="hamburger-menu"><div class="line1"></div><div class="line2"></div><div class="line3"></div></div></div><h2><i>›</i><span>Developer Guide: OPQ Cloud</span></h2><div class="tocToggler" id="tocToggler"><i class="icon-toc"></i></div></div><div class="navGroups"><div class="navGroup"><h3 class="navGroupCategoryTitle">Introduction</h3><ul class=""><li class="navListItem"><a class="navItem" href="/docs/intro-motivation.html">Motivation for OPQ</a></li><li class="navListItem"><a class="navItem" href="/docs/intro-power-quality.html">A beginner&#x27;s guide to power quality</a></li><li class="navListItem"><a class="navItem" href="/docs/intro-system-architecture.html">OPQ System Architecture</a></li><li class="navListItem"><a class="navItem" href="/docs/intro-information-architecture.html">OPQ Information Architecture</a></li><li class="navListItem"><a class="navItem" href="/docs/intro-related-work.html">Related Work</a></li><li class="navListItem"><a class="navItem" href="/docs/intro-bibliography.html">Bibliography</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle">User Guide</h3><ul class=""><li class="navListItem"><a class="navItem" href="/docs/userguide-hardware.html">OPQ Box</a></li><li class="navListItem"><a class="navItem" href="/docs/userguide-software.html">OPQ Cloud</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle">Developer Guide: OPQ Box</h3><ul class=""><li class="navListItem"><a class="navItem" href="/docs/box-overview.html">Overview</a></li><li class="navListItem"><a class="navItem" href="/docs/box-hardware-design.html">Hardware Design</a></li><li class="navListItem"><a class="navItem" href="/docs/box-software-design.html">Software Design</a></li><li class="navListItem"><a class="navItem" href="/docs/box-manufacturing.html">Manufacturing</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle">Developer Guide: OPQ Cloud</h3><ul class=""><li class="navListItem"><a class="navItem" href="/docs/cloud-overview.html">Overview</a></li><li class="navListItem"><a class="navItem" href="/docs/cloud-installation.html">Installation</a></li><li class="navListItem"><a class="navItem" href="/docs/cloud-datamodel.html">Data Model</a></li><li class="navListItem navListItemActive"><a class="navItem" href="/docs/cloud-view.html">View</a></li><li class="navListItem"><a class="navItem" href="/docs/cloud-mauka.html">Mauka</a></li><li class="navListItem"><a class="navItem" href="/docs/cloud-makai.html">Makai</a></li><li class="navListItem"><a class="navItem" href="/docs/cloud-health.html">Health</a></li><li class="navListItem"><a class="navItem" href="/docs/cloud-healthv2.html">Health v2</a></li><li class="navListItem"><a class="navItem" href="/docs/cloud-box-update-server.html">Box Update Server</a></li><li class="navListItem"><a class="navItem" href="/docs/cloud-mongodb.html">MongoDB</a></li><li class="navListItem"><a class="navItem" href="/docs/cloud-protocol.html">Protocol</a></li><li class="navListItem"><a class="navItem" href="/docs/cloud-port-map.html">Port Map</a></li><li class="navListItem"><a class="navItem" href="/docs/cloud-docker.html">Docker</a></li><li class="navListItem"><a class="navItem" href="/docs/cloud-migration.html">Cloud Migration</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle">Developer Guide: Misc</h3><ul class=""><li class="navListItem"><a class="navItem" href="/docs/developerguide-docusaurus.html">Documentation</a></li><li class="navListItem"><a class="navItem" href="/docs/developerguide-virtual-machine.html">VM &amp; Sim</a></li><li class="navListItem"><a class="navItem" href="/docs/developerguide-bibliography.html">Bibliography</a></li><li class="navListItem"><a class="navItem" href="/docs/developerguide-emilia-ssh.html">Emilia SSH</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle">Other</h3><ul class=""><li class="navListItem"><a class="navItem" href="/docs/other-roadmap.html">Roadmap</a></li><li class="navListItem"><a class="navItem" href="/docs/other-opportunities.html">R&amp;D Opportunities</a></li><li class="navListItem"><a class="navItem" href="/docs/other-agile-power-monitoring.html">Agile Power Monitoring for UH</a></li><li class="navListItem"><a class="navItem" href="/docs/other-g1-pilot-study.html">G1 Pilot Study (2014)</a></li></ul></div></div></section></div><script>
            var coll = document.getElementsByClassName('collapsible');
            var checkActiveCategory = true;
            for (var i = 0; i < coll.length; i++) {
              var links = coll[i].nextElementSibling.getElementsByTagName('*');
              if (checkActiveCategory){
                for (var j = 0; j < links.length; j++) {
                  if (links[j].classList.contains('navListItemActive')){
                    coll[i].nextElementSibling.classList.toggle('hide');
                    coll[i].childNodes[1].classList.toggle('rotate');
                    checkActiveCategory = false;
                    break;
                  }
                }
              }

              coll[i].addEventListener('click', function() {
                var arrow = this.childNodes[1];
                arrow.classList.toggle('rotate');
                var content = this.nextElementSibling;
                content.classList.toggle('hide');
              });
            }

            document.addEventListener('DOMContentLoaded', function() {
              createToggler('#navToggler', '#docsNav', 'docsSliderActive');
              createToggler('#tocToggler', 'body', 'tocActive');

              var headings = document.querySelector('.toc-headings');
              headings && headings.addEventListener('click', function(event) {
                var el = event.target;
                while(el !== headings){
                  if (el.tagName === 'A') {
                    document.body.classList.remove('tocActive');
                    break;
                  } else{
                    el = el.parentNode;
                  }
                }
              }, false);

              function createToggler(togglerSelector, targetSelector, className) {
                var toggler = document.querySelector(togglerSelector);
                var target = document.querySelector(targetSelector);

                if (!toggler) {
                  return;
                }

                toggler.onclick = function(event) {
                  event.preventDefault();

                  target.classList.toggle(className);
                };
              }
            });
        </script></nav></div><div class="container mainContainer"><div class="wrapper"><div class="post"><header class="postHeader"><h1 class="postHeaderTitle">OPQ View</h1></header><article><div><span><p>OPQ View is a web application that provides visualization, notification, and user management services.</p>
<h2><a class="anchor" aria-hidden="true" id="installation"></a><a href="#installation" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Installation</h2>
<h3><a class="anchor" aria-hidden="true" id="install-meteor"></a><a href="#install-meteor" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Install Meteor</h3>
<p>First, <a href="https://www.meteor.com/install">install Meteor</a>.</p>
<h3><a class="anchor" aria-hidden="true" id="install-libraries"></a><a href="#install-libraries" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Install libraries</h3>
<p>Now <a href="https://github.com/openpowerquality/opq/archive/master.zip">download a copy of OPQ</a>, or clone it using git.</p>
<p>Next, cd into the opq/view/app/ directory and install libraries with:</p>
<pre><code class="hljs">$ meteor npm <span class="hljs-keyword">install</span>
</code></pre>
<h3><a class="anchor" aria-hidden="true" id="configuration-viewconfigjson"></a><a href="#configuration-viewconfigjson" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Configuration (view.config.json)</h3>
<p>View is configured through a file called &quot;view.config.json&quot;.</p>
<p>The following table documents the two configuration properties that must be specified for each production environment: an admin user and the MAIL_URL:</p>
<table>
<thead>
<tr><th>Property</th><th>Description</th></tr>
</thead>
<tbody>
<tr><td>adminUser</td><td>A JSON object that defines the initial, admin user for a new OPQ Cloud instance. The admin user can login and then use OPQ View to define additional admin and/or regular users. See the required fields below.</td></tr>
<tr><td>adminUser.username</td><td>The admin username (an email address).  Must be changed from the default (&quot;<a href="mailto:adminuser@example.com">adminuser@example.com</a>&quot;)</td></tr>
<tr><td>adminUser.password</td><td>The admin password. Must be changed from the default (&quot;foo&quot;).</td></tr>
<tr><td>adminUser.firstName</td><td>The admin user's first name.</td></tr>
<tr><td>adminUser.lastName</td><td>The admin user's last name.</td></tr>
<tr><td>env</td><td>A JSON object that specifies environment variables. See the required fields below.</td></tr>
<tr><td>env.MAIL_URL</td><td>For OPQ email and text message notifications, a MAIL_URL value must be provided that provides an SMTP server address and password.</td></tr>
</tbody>
</table>
<p>For production, a sample version of the view.config.json configuration file is located in the opq-docker repository, at <a href="https://github.com/openpowerquality/opq-docker/blob/master/sample-config/view/view.config.json">opq-docker/sample-config/view/view.config.json</a>.</p>
<p>The person installing an OPQ Cloud will make a copy of the sample-config directory called config, then edit the config/view/view.config.json file to provide new values for adminUser and MAIL_URL. This edited version will be loaded when the user invokes the  <code>docker-compose-run.sh</code> script to bring up all of the OPQ Cloud services.</p>
<h3><a class="anchor" aria-hidden="true" id="additional-configuration-for-development-viewconfigjson"></a><a href="#additional-configuration-for-development-viewconfigjson" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Additional configuration for development (view.config.json)</h3>
<p>For development, a number of additional properties can be specified to aid in debugging, as summarized in this table:</p>
<table>
<thead>
<tr><th>Property</th><th>Description</th></tr>
</thead>
<tbody>
<tr><td>syncedCron</td><td>A JSON object controlling the behavior of the cron jobs running inside OPQ View.</td></tr>
<tr><td>syncedCron.logging</td><td>Debugging logs are disabled unless explicitly enabled by setting this property to true.</td></tr>
<tr><td>systemStats</td><td>A JSON object controlling the behavior of the SystemStats object inside OPQ View.</td></tr>
<tr><td>systemStats.updateIntervalSeconds</td><td>How often system stats are refreshed.  Defaults to once per minute.</td></tr>
<tr><td>healthCron</td><td>A JSON object controlling the behavior of the Health cron job inside OPQ View.</td></tr>
<tr><td>healthCron.enabled</td><td>The Health cron job is implicitly enabled unless this property is provided and set to false.</td></tr>
<tr><td>integrityCheck</td><td>A JSON object controlling the behavior of the entity integrity checking mechanism that is available in OPQ View.</td></tr>
<tr><td>integrityCheck.enabled</td><td>Integrity checking is disabled by default. Set this to true to enable it.</td></tr>
<tr><td>integrityCheck.verbose</td><td>Controls the amount of output associated with integrity checking.</td></tr>
<tr><td>integrityCheck.maxChecks</td><td>Controls how many entities to check. Entities are checked most-recent-first.</td></tr>
<tr><td>integrityCheck.repair</td><td>If true, then entities are repaired if possible.</td></tr>
<tr><td>integrityCheck.collections</td><td>An array indicating the entities (collections) to check.</td></tr>
<tr><td>initialEntities</td><td>A JSON object representing a set of entities to define upon startup.</td></tr>
<tr><td>initialEntities.enabled</td><td>Must be true in order for the specified entities to be loaded into the database. In addition, the entities are only loaded if the database is currently empty (i.e. there are no defined location or opqbox entities. See the code for how to override this safety feature.</td></tr>
<tr><td>initialEntities.opqBoxes</td><td>An array of objects, each specifying an OPQBox entity. See opq/view/config/view.config.json for details.</td></tr>
<tr><td>initialEntities.userProfiles</td><td>An array of objects, each specifying a user. See opq/view/config/view.config.json for details.</td></tr>
<tr><td>initialEntities.locations</td><td>An array of objects, each specifying a location entity. See opq/view/config/view.config.json for details.</td></tr>
<tr><td>initialEntities.regions</td><td>An array of objects, each specifying a region entity. See opq/view/config/view.config.json for details.</td></tr>
</tbody>
</table>
<p>For development, the view.config.json configuration file is located in the opq repository, at <a href="https://github.com/openpowerquality/opq/blob/master/view/config/view.config.json">opq/view/config/view.config.json</a>.  This file is loaded when the developer runs the <code>meteor npm run start</code> script.</p>
<h3><a class="anchor" aria-hidden="true" id="use-snapshot-db-optional"></a><a href="#use-snapshot-db-optional" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Use snapshot DB (optional)</h3>
<p>For OPQView development, it can be useful to initialize your development database with a snapshot of OPQ data. Here are the steps to do so.</p>
<p><a href="https://docs.mongodb.com/manual/installation/">Install MongoDB</a>.  Even though Meteor comes with a copy of Mongo, you will need to install MongoDB in order to run the mongorestore command.</p>
<p>Download a snapshot of an OPQ database into a directory outside of the opq repository directory. (This is to avoid unintentional committing of the DB snapshot). Here is a link to a recent DB snapshot:</p>
<ul>
<li>(No snapshot available at this time.)</li>
</ul>
<p>Uncompress the downloaded tar.gz file. (Typically, double-clicking the file name will do the trick.) This will create a directory called &quot;opq&quot;.</p>
<p>Delete the current contents of your local development OPQ database. To do this, stop Meteor if it is running, then invoke</p>
<pre><code class="hljs"><span class="hljs-attribute">meteor reset</span>
</code></pre>
<p>Start meteor so that the development version of MongoDB is started. Do not run the 'start' script, just invoke <code>meteor</code>. This is to prevent OPQBoxes from being created twice:</p>
<pre><code class="hljs"><span class="hljs-attribute">meteor</span>
</code></pre>
<p>Bring up a second command shell, then cd to the directory containing the &quot;opq&quot; snapshot directory, and run:</p>
<pre><code class="hljs">mongorestore -h <span class="hljs-number">127.0</span><span class="hljs-number">.0</span><span class="hljs-number">.1</span> --port <span class="hljs-number">3001</span> --gzip -d meteor opq
</code></pre>
<p>Here is an excerpt of the sample output from running the above command. It will take up to 10 minutes:</p>
<pre><code class="hljs">mongorestore -h <span class="hljs-number">127.0</span><span class="hljs-number">.0</span><span class="hljs-number">.1</span> --port <span class="hljs-number">3001</span> --gzip -d meteor opq
<span class="hljs-number">2018</span><span class="hljs-number">-01</span><span class="hljs-number">-29</span>T14:<span class="hljs-number">50</span>:<span class="hljs-number">49.999</span><span class="hljs-number">-1000</span>    building a list of collections to restore <span class="hljs-keyword">from</span> opq dir

                  (many lines deleted)

<span class="hljs-number">2018</span><span class="hljs-number">-01</span><span class="hljs-number">-29</span>T14:<span class="hljs-number">53</span>:<span class="hljs-number">01.999</span><span class="hljs-number">-1000</span>    finished restoring meteor.fs.chunks (<span class="hljs-number">55639</span> documents)
<span class="hljs-number">2018</span><span class="hljs-number">-01</span><span class="hljs-number">-29</span>T14:<span class="hljs-number">53</span>:<span class="hljs-number">01.999</span><span class="hljs-number">-1000</span>    done
</code></pre>
<p>Control-c to exit Meteor.  This is important, since you brought up Meteor without the settings file.</p>
<h3><a class="anchor" aria-hidden="true" id="use-production-db-optional"></a><a href="#use-production-db-optional" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Use production DB (optional)</h3>
<p>An alternative to loading a snapshot of the database into your local Mongo database is to connect directly to the Mongo database running on emilia.  This is good because you can, for example, test out real-time components on a database that is constantly receiving new data from boxes. It is bad because your development application now has the ability to mess up the production database.  Be careful.</p>
<p>Here are the steps to enabling your development version of OPQView utilize the production database on emilia:</p>
<p><strong>1. Obtain an account on emilia.ics.hawaii.edu</strong></p>
<p>See Anthony who will provide you with the credentials. Usually this will be the account &quot;opquser&quot;.</p>
<p><strong>2. Forward emilia.ics.hawaii.edu:27017 to localhost:27017</strong></p>
<p>Once you have an account on emilia, you can use ssh port forwarding to create a port on your local machine that acts as if it was the MongoDB port on emilia.  Open a new shell, and execute the following command:</p>
<pre><code class="hljs">$ ssh -C -<span class="hljs-selector-tag">p</span> <span class="hljs-number">29862</span> -N -L <span class="hljs-number">27017</span>:localhost:<span class="hljs-number">27017</span> opquser@emilia<span class="hljs-selector-class">.ics</span><span class="hljs-selector-class">.hawaii</span><span class="hljs-selector-class">.edu</span>
</code></pre>
<p>You'll need to replace <code>opquser</code> if that's not the account you're using, and you'll need to supply the correct password after executing this command. Once you successfully provide your password, port forwarding will have started.  When you no longer want port forwarding, you can control-c or close the shell.</p>
<p><strong>3. Run OPQView, specifying an alternative MongoDB port</strong></p>
<p>To run OPQView and connect to the database on emilia, invoke the following command:</p>
<pre><code class="hljs">$ <span class="hljs-attribute">MONGO_URL</span>=<span class="hljs-string">'mongodb://localhost:27017/opq'</span> meteor npm <span class="hljs-builtin-name">run</span> start
</code></pre>
<p>This is simply the normal command to invoke OPQView (i.e. <code>meteor npm run start</code>, prefixed with the definition of the MONGO_URL environment variable specifying the port and database name associated with emilia.)</p>
<h3><a class="anchor" aria-hidden="true" id="run-opqview"></a><a href="#run-opqview" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Run OPQView</h3>
<p>To start up OPQView on the local development database, run Meteor using our start script as follows:</p>
<pre><code class="hljs">meteor npm <span class="hljs-keyword">run</span><span class="bash"> start</span>
</code></pre>
<p>You should seem messages like this in the console:</p>
<pre><code class="hljs">$ meteor npm run start

&gt; opqview@ start /Users/philipjohnson/github/openpowerquality/opq/view/app
&gt; meteor --settings ../config/settings.development.json

[[[[[ ~/github/openpowerquality/opq/view/app ]]]]]

=&gt; Started proxy.
=&gt; Started MongoDB.
<span class="hljs-symbol">I20180328</span>-<span class="hljs-symbol">12:38</span><span class="hljs-symbol">:05</span>.<span class="hljs-number">148</span>(-<span class="hljs-number">10</span>)? Starting SyncedCron to update System Stats every <span class="hljs-number">10</span> seconds.
<span class="hljs-symbol">I20180328</span>-<span class="hljs-symbol">12:38</span><span class="hljs-symbol">:05</span>.<span class="hljs-number">207</span>(-<span class="hljs-number">10</span>)? Initializing <span class="hljs-number">4</span> user profiles.
<span class="hljs-symbol">I20180328</span>-<span class="hljs-symbol">12:38</span><span class="hljs-symbol">:05</span>.<span class="hljs-number">207</span>(-<span class="hljs-number">10</span>)? Initializing <span class="hljs-number">5</span> OPQ boxes.
=&gt; Started your app.

=&gt; App running <span class="hljs-symbol">at:</span> ht<span class="hljs-symbol">tp:</span>//localho<span class="hljs-symbol">st:3000</span>/
</code></pre>
<p>You should be able to see the OPQView landing page at <a href="http://localhost:3000">http://localhost:3000</a>.  It looks like this:</p>
<p><img src="/docs/assets/view/opqview-landing-page.png" ></p>
<h2><a class="anchor" aria-hidden="true" id="development-environment"></a><a href="#development-environment" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Development Environment</h2>
<h3><a class="anchor" aria-hidden="true" id="meteor"></a><a href="#meteor" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Meteor</h3>
<p>From past experience, developers who are new to Meteor and who are using Windows can find Meteor startup and recompilation times to be excessive.  Mac and Unix developers do not generally experience these issues.  Here are <a href="http://courses.ics.hawaii.edu/ics314s18/morea/meteor-1/reading-meteor-tips.html#windows-specific-meteor-tips">a collection of Windows-specific Meteor tips</a> that might prove useful.</p>
<h3><a class="anchor" aria-hidden="true" id="intellij-idea"></a><a href="#intellij-idea" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>IntelliJ IDEA</h3>
<p>For OPQ View development, we highly recommend <a href="https://www.jetbrains.com/idea/">IntelliJ IDEA</a> with plugins for Javascript, Meteor, and ESLint. If you are new to IntelliJ IDEA, we recommend that you review the <a href="http://courses.ics.hawaii.edu/ics314s18/modules/development-environments/">ICS 314 Development Environments module</a> and more specifically the <a href="http://courses.ics.hawaii.edu/ics314s18/morea/development-environments/experience-install-intellij-idea.html">Install IntelliJ IDEA experience</a> for detailed instructions on how to install and configure IntelliJ IDEA for effective Javascript development. For example, the ICS SE Code Style preferences help IntelliJ to automatically format code to comply with ESLint.</p>
<h3><a class="anchor" aria-hidden="true" id="eslint"></a><a href="#eslint" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>ESLint</h3>
<p><a href="https://eslint.org/">ESLint</a> is a static quality assurance tool that helps ensure that Javascript code conforms to best practices. For example, it can flag uses of <code>==</code>,  which should almost always be replaced by <code>===</code>.  For novice Javascript developers, ESLint can detect many significant problems in code due to inappropriate language use, and for more experienced Javascript developers, ESLint can help identify places where code can be improved by use of ES6 (and later) language constructs.</p>
<p>To install ESLint in your development environment, please follow the instructions in the <a href="http://courses.ics.hawaii.edu/ics314s18/morea/coding-standards/experience-install-eslint.html">Improve code quality using ESLint in IntelliJ</a>.</p>
<h3><a class="anchor" aria-hidden="true" id="react"></a><a href="#react" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>React</h3>
<p><a href="https://reactjs.org/">React</a> is the Javascript framework used to build the OPQ View user interface. More specifically, we use a library built on top of React called <a href="https://react.semantic-ui.com/">Semantic UI React</a>.</p>
<p>If you are not familiar with React or Semantic UI, you might want to work through the <a href="http://courses.ics.hawaii.edu/ics314s18/modules/react/">ICS 314 React Module</a>, which has a curated set of tutorial exercises.</p>
<p>Once you have basic familiarity with React, you can hopefully become facile with Semantic UI React by reading the OPQ View code. It's pretty straightforward, and the Semantic UI React documentation is excellent.</p>
<h3><a class="anchor" aria-hidden="true" id="uniforms"></a><a href="#uniforms" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Uniforms</h3>
<p>For form implementation, we use the <a href="https://github.com/vazco/uniforms">vazco/uniforms</a> package, which simplifies form implementation, is well maintained, and works well with both Meteor and Semantic UI.</p>
<h3><a class="anchor" aria-hidden="true" id="react-time-series-charts"></a><a href="#react-time-series-charts" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>React Time Series Charts</h3>
<p>For charts and visualizations, our first choice is the <a href="http://software.es.net/react-timeseries-charts/#/">ESNet React Time Series Charts</a>.  This charting library is designed with a variety of special features for time series data visualization.  Please try this package first, and consult other developers if you believe a different package will better suit your visualization needs.</p>
<h2><a class="anchor" aria-hidden="true" id="quality-assurance"></a><a href="#quality-assurance" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Quality Assurance</h2>
<h3><a class="anchor" aria-hidden="true" id="coding-standards"></a><a href="#coding-standards" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Coding standards</h3>
<p>As noted above, we use ESLint to help ensure that OPQ View code adheres to the current best practices for Javascript and Meteor development.</p>
<p>To manually invoke ESLint, invoke <code>meteor npm run lint</code>. Here is an example invocation:</p>
<pre><code class="hljs">app$ meteor npm run lint

&gt; opqview@ lint <span class="hljs-string">/Users/philipjohnson/github/openpowerquality/opq/view/app</span>
&gt; eslint <span class="hljs-params">--quiet</span> <span class="hljs-params">--ext</span> <span class="hljs-string">.jsx</span> <span class="hljs-params">--ext</span> <span class="hljs-string">.js</span> <span class="hljs-string">./imports</span>
</code></pre>
<p>Any violations will be reported and the command will exit with a non-zero exit code.</p>
<p>Being able to run ESLint from the commmand line is important in order to support continuous integration, but the most efficient way for developers to maintain compliance with ESLint is to install it into your IDE. Please follow the instructions <a href="/docs/cloud-view.html#eslint">above</a> to install ESLint into IntelliJ IDEA.</p>
<h3><a class="anchor" aria-hidden="true" id="data-model-testing"></a><a href="#data-model-testing" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Data model testing</h3>
<p>In OPQ View, <a href="https://guide.meteor.com/testing.html">Meteor unit testing</a> is implemented as server-side testing of the data model contained in the <code>view/app/imports/api</code> directory. A recent version of this directory looks in part like this:</p>
<pre><code class="hljs"><span class="hljs-symbol">api</span>/
  <span class="hljs-keyword">base/
</span>  <span class="hljs-keyword">box-events
</span>  events/
  fs-chunks/
  fs-files/
  health/
  locations/
  measurements/
  opq/
  opq-<span class="hljs-keyword">boxes/
</span>  regions/
  system-stats/
  test/
  trends/
  users/
</code></pre>
<p>Most of these directories contain files that implement an entity in the <a href="/docs/cloud-datamodel.html">OPQ Data Model</a>, such as &quot;Event&quot; or &quot;Measurement&quot;. Each entity is implemented as a Javascript Class that encapsulates access to the underlying MongoDB collection, and also provides higher level methods (such as <code>define</code>, <code>update</code>, and <code>remove</code>) that ensure that the integrity of the data model is maintained as objects are created, modified, and deleted.</p>
<p>To test that these entity implementations work correctly, data model classes have a corresponding test file with suffix <code>test.js</code>.   We use the <a href="https://mochajs.org/">Mocha</a> test runner and  <a href="http://chaijs.com/guide/styles/#expect">Chai Expect Assertions</a> libraries to implement the tests. Here is an excerpt from the <a href="https://github.com/openpowerquality/opq/blob/master/view/app/imports/api/trends/TrendsCollection.test.js">TrendsCollection.test.js</a> file that illustrates unit tests:</p>
<pre><code class="hljs"><span class="hljs-keyword">if</span> (Meteor.isServer) {
  describe(<span class="hljs-string">'TrendsCollection'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">testSuite</span>(<span class="hljs-params"></span>) </span>{
    before(<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">setup</span>(<span class="hljs-params"></span>) </span>{
      Trends.removeAll();
      OpqBoxes.removeAll();
    });

    after(<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">tearDown</span>(<span class="hljs-params"></span>) </span>{
      Trends.removeAll();
      OpqBoxes.removeAll();
    });

    <span class="hljs-keyword">const</span> box_id = <span class="hljs-string">'1'</span>;
    <span class="hljs-keyword">const</span> calibration_constant = <span class="hljs-number">1</span>;
    <span class="hljs-keyword">const</span> trend1 = { <span class="hljs-attr">min</span>: <span class="hljs-number">-100</span>, <span class="hljs-attr">max</span>: <span class="hljs-number">100</span>, <span class="hljs-attr">average</span>: <span class="hljs-number">0</span> };
    <span class="hljs-keyword">const</span> trend2 = { <span class="hljs-attr">min</span>: <span class="hljs-number">0</span>, <span class="hljs-attr">max</span>: <span class="hljs-number">0</span>, <span class="hljs-attr">average</span>: <span class="hljs-number">0</span> };
    <span class="hljs-keyword">const</span> trend3 = { <span class="hljs-attr">min</span>: <span class="hljs-number">-50</span>, <span class="hljs-attr">max</span>: <span class="hljs-number">25</span>, <span class="hljs-attr">average</span>: <span class="hljs-number">10</span> };
    <span class="hljs-keyword">const</span> startDateString = <span class="hljs-string">'2018-01-01T12:00:00'</span>;
    <span class="hljs-keyword">let</span> timestamp_ms = moment(startDateString).valueOf();

    it(<span class="hljs-string">'#define, #isDefined'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">test</span>(<span class="hljs-params"></span>) </span>{
      <span class="hljs-comment">// Test that we can create and retrieve a simple Trend document.</span>
      OpqBoxes.define({ box_id, calibration_constant });
      <span class="hljs-keyword">const</span> trendId = Trends.define({ box_id, timestamp_ms, <span class="hljs-attr">voltage</span>: trend1, <span class="hljs-attr">frequency</span>: trend1, <span class="hljs-attr">thd</span>: trend1 });
      expect(Trends.isDefined(trendId)).to.exist;

      <span class="hljs-comment">// Add two more trends to January 1, 2018 in order to set up further tests.</span>
      timestamp_ms += <span class="hljs-number">1</span>;
      Trends.define({ box_id, timestamp_ms, <span class="hljs-attr">voltage</span>: trend2, <span class="hljs-attr">frequency</span>: trend2, <span class="hljs-attr">thd</span>: trend2 });
      timestamp_ms += <span class="hljs-number">1</span>;
      <span class="hljs-comment">// No thd field in this last one.</span>
      Trends.define({ box_id, timestamp_ms, <span class="hljs-attr">voltage</span>: trend3, <span class="hljs-attr">frequency</span>: trend3 });
    });

<span class="hljs-comment">// additional unit tests follow...</span>
</code></pre>
<p>As you can see, there is code to set up and tear down the test fixture, and a unit test to exercise the define() and isDefined() methods in the Trends class instance.</p>
<p>To manually invoke all of the unit tests, use <code>meteor npm run test</code>. Here is an example invocation:</p>
<pre><code class="hljs">~/g/o/o/v/app (master|✔) $ meteor npm run test

&gt; <span class="hljs-symbol">opqview@</span> test /Users/philipjohnson/github/openpowerquality/opq/view/app
&gt; METEOR_NO_RELEASE_CHECK=<span class="hljs-number">1</span> TEST_BROWSER_DRIVER=nightmare meteor test --once --driver-package meteortesting:mocha --no-release-check --port <span class="hljs-number">3100</span>

[[[[[ Tests ]]]]]

=&gt; Started proxy.
=&gt; Started MongoDB.
I20180522<span class="hljs-number">-16</span>:<span class="hljs-number">07</span>:<span class="hljs-number">41.049</span>(<span class="hljs-number">-10</span>)?
I20180522<span class="hljs-number">-16</span>:<span class="hljs-number">07</span>:<span class="hljs-number">41.087</span>(<span class="hljs-number">-10</span>)? --------------------------------
I20180522<span class="hljs-number">-16</span>:<span class="hljs-number">07</span>:<span class="hljs-number">41.088</span>(<span class="hljs-number">-10</span>)? ----- RUNNING SERVER TESTS -----
I20180522<span class="hljs-number">-16</span>:<span class="hljs-number">07</span>:<span class="hljs-number">41.088</span>(<span class="hljs-number">-10</span>)? --------------------------------
I20180522<span class="hljs-number">-16</span>:<span class="hljs-number">07</span>:<span class="hljs-number">41.088</span>(<span class="hljs-number">-10</span>)?
I20180522<span class="hljs-number">-16</span>:<span class="hljs-number">07</span>:<span class="hljs-number">41.088</span>(<span class="hljs-number">-10</span>)?
I20180522<span class="hljs-number">-16</span>:<span class="hljs-number">07</span>:<span class="hljs-number">41.089</span>(<span class="hljs-number">-10</span>)?
I20180522<span class="hljs-number">-16</span>:<span class="hljs-number">07</span>:<span class="hljs-number">41.089</span>(<span class="hljs-number">-10</span>)?   LocationsCollection
=&gt; Started your app.

=&gt; App running at: http:<span class="hljs-comment">//localhost:3100/</span>
    ✓ #define, #findLocation (<span class="hljs-number">212</span>ms)
I20180522<span class="hljs-number">-16</span>:<span class="hljs-number">07</span>:<span class="hljs-number">41.275</span>(<span class="hljs-number">-10</span>)?
I20180522<span class="hljs-number">-16</span>:<span class="hljs-number">07</span>:<span class="hljs-number">41.275</span>(<span class="hljs-number">-10</span>)?   RegionsCollection
    ✓ #define, #findLocationsForRegion, #findRegionsForLocation (<span class="hljs-number">66</span>ms)
I20180522<span class="hljs-number">-16</span>:<span class="hljs-number">07</span>:<span class="hljs-number">41.382</span>(<span class="hljs-number">-10</span>)?
I20180522<span class="hljs-number">-16</span>:<span class="hljs-number">07</span>:<span class="hljs-number">41.382</span>(<span class="hljs-number">-10</span>)?   BoxOwnersCollection
    ✓ #define, #findBoxesWithOwner, #findOwnersWithBox (<span class="hljs-number">58</span>ms)
I20180522<span class="hljs-number">-16</span>:<span class="hljs-number">07</span>:<span class="hljs-number">41.408</span>(<span class="hljs-number">-10</span>)?
I20180522<span class="hljs-number">-16</span>:<span class="hljs-number">07</span>:<span class="hljs-number">41.408</span>(<span class="hljs-number">-10</span>)?   UserProfilesCollection
    ✓ #define, #isDefined, #findBoxIds, #findDoc, #findOne, #remove (<span class="hljs-number">161</span>ms)
I20180522<span class="hljs-number">-16</span>:<span class="hljs-number">07</span>:<span class="hljs-number">41.572</span>(<span class="hljs-number">-10</span>)?
I20180522<span class="hljs-number">-16</span>:<span class="hljs-number">07</span>:<span class="hljs-number">41.572</span>(<span class="hljs-number">-10</span>)?
I20180522<span class="hljs-number">-16</span>:<span class="hljs-number">07</span>:<span class="hljs-number">41.572</span>(<span class="hljs-number">-10</span>)?   <span class="hljs-number">4</span> passing (<span class="hljs-number">524</span>ms)
I20180522<span class="hljs-number">-16</span>:<span class="hljs-number">07</span>:<span class="hljs-number">41.572</span>(<span class="hljs-number">-10</span>)?
I20180522<span class="hljs-number">-16</span>:<span class="hljs-number">07</span>:<span class="hljs-number">41.573</span>(<span class="hljs-number">-10</span>)?
I20180522<span class="hljs-number">-16</span>:<span class="hljs-number">07</span>:<span class="hljs-number">41.573</span>(<span class="hljs-number">-10</span>)? --------------------------------
I20180522<span class="hljs-number">-16</span>:<span class="hljs-number">07</span>:<span class="hljs-number">41.573</span>(<span class="hljs-number">-10</span>)? ----- RUNNING CLIENT TESTS -----
I20180522<span class="hljs-number">-16</span>:<span class="hljs-number">07</span>:<span class="hljs-number">41.573</span>(<span class="hljs-number">-10</span>)? --------------------------------
I20180522<span class="hljs-number">-16</span>:<span class="hljs-number">07</span>:<span class="hljs-number">43.033</span>(<span class="hljs-number">-10</span>)?
I20180522<span class="hljs-number">-16</span>:<span class="hljs-number">07</span>:<span class="hljs-number">43.035</span>(<span class="hljs-number">-10</span>)?
I20180522<span class="hljs-number">-16</span>:<span class="hljs-number">07</span>:<span class="hljs-number">43.036</span>(<span class="hljs-number">-10</span>)?   <span class="hljs-number">0</span> passing (<span class="hljs-number">3</span>ms)
I20180522<span class="hljs-number">-16</span>:<span class="hljs-number">07</span>:<span class="hljs-number">43.036</span>(<span class="hljs-number">-10</span>)?
I20180522<span class="hljs-number">-16</span>:<span class="hljs-number">07</span>:<span class="hljs-number">43.093</span>(<span class="hljs-number">-10</span>)? All tests finished!
I20180522<span class="hljs-number">-16</span>:<span class="hljs-number">07</span>:<span class="hljs-number">43.093</span>(<span class="hljs-number">-10</span>)?
I20180522<span class="hljs-number">-16</span>:<span class="hljs-number">07</span>:<span class="hljs-number">43.094</span>(<span class="hljs-number">-10</span>)? --------------------------------
I20180522<span class="hljs-number">-16</span>:<span class="hljs-number">07</span>:<span class="hljs-number">43.094</span>(<span class="hljs-number">-10</span>)? SERVER FAILURES: <span class="hljs-number">0</span>
I20180522<span class="hljs-number">-16</span>:<span class="hljs-number">07</span>:<span class="hljs-number">43.094</span>(<span class="hljs-number">-10</span>)? CLIENT FAILURES: <span class="hljs-number">0</span>
I20180522<span class="hljs-number">-16</span>:<span class="hljs-number">07</span>:<span class="hljs-number">43.094</span>(<span class="hljs-number">-10</span>)? --------------------------------
~/g/o/o/v/app (master|✔) $
</code></pre>
<p>There should be no server or client failures listed. There will also be no client tests at all. In OPQ View, all unit tests occur on the server side.</p>
<h3><a class="anchor" aria-hidden="true" id="meteor-method-testing"></a><a href="#meteor-method-testing" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Meteor Method testing</h3>
<p>When OPQ View client-side code needs to modify the contents of the MongoDB database, or perform complex data queries, it does this via <a href="https://guide.meteor.com/methods.html">Meteor Methods</a>, which is basically a remote procedure call system.</p>
<p>We can validate the correct functioning of OPQ View's Meteor Methods using Meteor's &quot;full app&quot; testing mode.  This mode runs all of the tests in files named with the suffix <code>app-test.js</code>. In OPQ, the goal of &quot;full app&quot; testing is to exercise the remote procedure calls from the client to the server and make sure they can be invoked correctly.  Here is an excerpt from the <a href="https://github.com/openpowerquality/opq/blob/master/view/app/imports/api/trends/TrendsCollection.methods.app-test.js">TrendsCollection.methods.app-test.js</a> file that shows a test of the &quot;dailyTrends&quot; Meteor Method:</p>
<pre><code class="hljs"><span class="hljs-keyword">if</span> (Meteor.isClient) {
  describe(<span class="hljs-string">'TrendsCollection Meteor Methods '</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">test</span>(<span class="hljs-params"></span>) </span>{

    before(<span class="hljs-keyword">async</span> <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{
      <span class="hljs-keyword">await</span> defineTestFixturesMethod.callPromise([<span class="hljs-string">'minimal'</span>, <span class="hljs-string">'trends'</span>]);
      <span class="hljs-keyword">await</span> withLoggedInUser();
    });

    it(<span class="hljs-string">'Trends.dailyTrends Method'</span>, <span class="hljs-keyword">async</span> <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{
      <span class="hljs-keyword">const</span> boxIDs = [<span class="hljs-string">'1000'</span>];
      <span class="hljs-keyword">const</span> startDate_ms = moment(<span class="hljs-string">'2018-01-01'</span>).valueOf();
      <span class="hljs-keyword">const</span> endDate_ms = moment(<span class="hljs-string">'2018-01-02'</span>).valueOf();
      <span class="hljs-keyword">const</span> trendData = <span class="hljs-keyword">await</span> dailyTrends.callPromise({ boxIDs, startDate_ms, endDate_ms });
      <span class="hljs-keyword">const</span> jan1data = trendData[<span class="hljs-string">'1000'</span>][startDate_ms];
      expect(jan1data).to.exist;
      expect(jan1data.frequency.min).to.equal(<span class="hljs-number">60</span>);
      expect(jan1data.frequency.max).to.equal(<span class="hljs-number">70</span>);
      expect(jan1data.frequency.average).to.equal(<span class="hljs-number">65</span>);
      expect(jan1data.frequency.count).to.equal(<span class="hljs-number">2</span>);
    });
  });
}
</code></pre>
<p>Testing the remote procedure call (Meteor Method) interface between client and server requires more complex setup than unit testing.  The first complication is that RPC calls are (by definition) asynchronous, and thus there is the possibility of entering &quot;<a href="http://callbackhell.com/">callback hell</a>&quot; if a sequence of asynchronous calls are required to do the tests. In order to avoid this problem, OPQ full app tests use the <a href="https://javascript.info/async-await">async/await</a> constructs in Javascript to force asynchronous code to execute synchronously. In the code above, the before() method calls two asynchronous functions in a row, but the use of async/await means that execution will pause after each call until it completes. This is even more important in the test itself:</p>
<pre><code class="hljs">const trendData = await dailyTrends.call<span class="hljs-constructor">Promise({ <span class="hljs-params">boxIDs</span>, <span class="hljs-params">startDate_ms</span>, <span class="hljs-params">endDate_ms</span> })</span>;
</code></pre>
<p>In this code, the dailyTrends Meteor Method is called, then execution pauses until it completes, and the results are assigned to the variable trendData. This is much easier to code and understand than providing callback functions.</p>
<p>There are several utility functions provided to facilitate testing in the <a href="https://github.com/openpowerquality/opq/blob/master/view/app/imports/api/test/test-utilities.js">test-utilities.js</a>. <code>withLoggedInUser</code> logs the client in as a test user (with Admin privileges). Without this, most RPC calls will fail with a &quot;unauthorized or not logged in user&quot; error.  <code>withOpqSubscriptions</code> subscribes the client to a variety of collections in case the test requires access to client-side data.  <code>defineTestFixtures</code> loads test data from the <a href="https://github.com/openpowerquality/opq/tree/master/view/app/private/database/fixture">private/database/fixture</a> directory. This simplifies tests by making it easy to seed the test database with sample data.</p>
<p>To manually invoke Meteor Method testing, invoke <code>meteor npm run test-app</code>. Here is an example invocation:</p>
<pre><code class="hljs css language-default"><span class="hljs-string">~/g/o/o/v/app</span> <span class="hljs-string">(master|✔)</span> <span class="hljs-string">$</span> <span class="hljs-string">meteor</span> <span class="hljs-string">npm</span> <span class="hljs-string">run</span> <span class="hljs-string">test-app</span>

<span class="hljs-string">&gt; opqview@ test-app /Users/philipjohnson/github/openpowerquality/opq/view/app
&gt; METEOR_NO_RELEASE_CHECK=1 TEST_BROWSER_DRIVER=nightmare meteor test --full-app --once --driver-package meteortesting:mocha --port 3100

[[[[[ Tests ]]]]]

=&gt; Started proxy.
=&gt; Started MongoDB.
</span><span class="hljs-attr">I20180522-16:</span><span class="hljs-number">11</span><span class="hljs-string">:43.843(-10)?</span>
<span class="hljs-attr">I20180522-16:</span><span class="hljs-number">11</span><span class="hljs-string">:43.890(-10)?</span> <span class="hljs-bullet">--------------------------------</span>
<span class="hljs-attr">I20180522-16:</span><span class="hljs-number">11</span><span class="hljs-string">:43.891(-10)?</span> <span class="hljs-meta">---</span> <span class="hljs-string">RUNNING</span> <span class="hljs-string">APP</span> <span class="hljs-string">SERVER</span> <span class="hljs-string">TESTS</span> <span class="hljs-meta">---</span>
<span class="hljs-attr">I20180522-16:</span><span class="hljs-number">11</span><span class="hljs-string">:43.891(-10)?</span> <span class="hljs-bullet">--------------------------------</span>
<span class="hljs-attr">I20180522-16:</span><span class="hljs-number">11</span><span class="hljs-string">:43.892(-10)?</span>
<span class="hljs-attr">I20180522-16:</span><span class="hljs-number">11</span><span class="hljs-string">:43.892(-10)?</span>
<span class="hljs-attr">I20180522-16:</span><span class="hljs-number">11</span><span class="hljs-string">:43.892(-10)?</span>
<span class="hljs-attr">I20180522-16:</span><span class="hljs-number">11</span><span class="hljs-string">:43.893(-10)?</span>   <span class="hljs-number">0</span> <span class="hljs-string">passing</span> <span class="hljs-string">(0ms)</span>
<span class="hljs-attr">I20180522-16:</span><span class="hljs-number">11</span><span class="hljs-string">:43.893(-10)?</span>
<span class="hljs-attr">I20180522-16:</span><span class="hljs-number">11</span><span class="hljs-string">:43.893(-10)?</span>
<span class="hljs-attr">I20180522-16:</span><span class="hljs-number">11</span><span class="hljs-string">:43.893(-10)?</span> <span class="hljs-bullet">--------------------------------</span>
<span class="hljs-attr">I20180522-16:</span><span class="hljs-number">11</span><span class="hljs-string">:43.894(-10)?</span> <span class="hljs-meta">---</span> <span class="hljs-string">RUNNING</span> <span class="hljs-string">APP</span> <span class="hljs-string">CLIENT</span> <span class="hljs-string">TESTS</span> <span class="hljs-meta">---</span>
<span class="hljs-attr">I20180522-16:</span><span class="hljs-number">11</span><span class="hljs-string">:43.894(-10)?</span> <span class="hljs-bullet">--------------------------------</span>
<span class="hljs-attr">I20180522-16:</span><span class="hljs-number">11</span><span class="hljs-string">:44.014(-10)?</span> <span class="hljs-string">Defining</span> <span class="hljs-string">test</span> <span class="hljs-attr">user:</span> <span class="hljs-string">opqtestuser@hawaii.edu</span>
<span class="hljs-string">=&gt;</span> <span class="hljs-string">Started</span> <span class="hljs-string">your</span> <span class="hljs-string">app.</span>

<span class="hljs-string">=&gt;</span> <span class="hljs-string">App</span> <span class="hljs-string">running</span> <span class="hljs-attr">at:</span> <span class="hljs-attr">http://localhost:3100/</span>
<span class="hljs-attr">I20180522-16:</span><span class="hljs-number">11</span><span class="hljs-string">:46.286(-10)?</span>
<span class="hljs-attr">I20180522-16:</span><span class="hljs-number">11</span><span class="hljs-string">:46.286(-10)?</span>
<span class="hljs-attr">I20180522-16:</span><span class="hljs-number">11</span><span class="hljs-string">:46.496(-10)?</span>   <span class="hljs-string">UserProfilesCollection</span> <span class="hljs-string">Meteor</span> <span class="hljs-string">Methods</span>
<span class="hljs-attr">I20180522-16:</span><span class="hljs-number">11</span><span class="hljs-string">:46.589(-10)?</span>     <span class="hljs-string">Loaded</span> <span class="hljs-string">database/fixture/minimal.fixture.json:</span> <span class="hljs-string">Defines</span> <span class="hljs-string">a</span> <span class="hljs-string">single</span> <span class="hljs-string">entity</span> <span class="hljs-string">in</span> <span class="hljs-string">a</span> <span class="hljs-string">selection</span> <span class="hljs-string">of</span> <span class="hljs-string">OPQ</span> <span class="hljs-string">collections</span> <span class="hljs-string">to</span> <span class="hljs-string">show</span> <span class="hljs-string">how</span> <span class="hljs-string">it's</span> <span class="hljs-string">done.</span>
<span class="hljs-attr">I20180522-16:</span><span class="hljs-number">11</span><span class="hljs-string">:46.589(-10)?</span> <span class="hljs-string">Defining</span> <span class="hljs-number">2</span> <span class="hljs-string">locations</span> <span class="hljs-string">documents.</span>
<span class="hljs-attr">I20180522-16:</span><span class="hljs-number">11</span><span class="hljs-string">:46.655(-10)?</span> <span class="hljs-string">Defining</span> <span class="hljs-number">2</span> <span class="hljs-string">regions</span> <span class="hljs-string">documents.</span>
<span class="hljs-attr">I20180522-16:</span><span class="hljs-number">11</span><span class="hljs-string">:46.725(-10)?</span> <span class="hljs-string">Defining</span> <span class="hljs-number">2</span> <span class="hljs-string">opq_boxes</span> <span class="hljs-string">documents.</span>
<span class="hljs-attr">I20180522-16:</span><span class="hljs-number">11</span><span class="hljs-string">:46.789(-10)?</span> <span class="hljs-string">Defining</span> <span class="hljs-number">2</span> <span class="hljs-string">UserProfiles</span> <span class="hljs-string">documents.</span>
<span class="hljs-attr">I20180522-16:</span><span class="hljs-number">11</span><span class="hljs-string">:47.056(-10)?</span> <span class="hljs-string">Defining</span> <span class="hljs-number">0</span> <span class="hljs-string">events</span> <span class="hljs-string">documents.</span>
<span class="hljs-attr">I20180522-16:</span><span class="hljs-number">11</span><span class="hljs-string">:47.056(-10)?</span> <span class="hljs-string">Defining</span> <span class="hljs-number">0</span> <span class="hljs-string">box_events</span> <span class="hljs-string">documents.</span>
<span class="hljs-attr">I20180522-16:</span><span class="hljs-number">11</span><span class="hljs-string">:47.056(-10)?</span> <span class="hljs-string">Defining</span> <span class="hljs-number">0</span> <span class="hljs-string">trends</span> <span class="hljs-string">documents.</span>
<span class="hljs-attr">I20180522-16:</span><span class="hljs-number">11</span><span class="hljs-string">:47.426(-10)?</span>     <span class="hljs-string">✓</span> <span class="hljs-string">Verify</span> <span class="hljs-string">DB</span> <span class="hljs-string">fixture</span>
<span class="hljs-attr">I20180522-16:</span><span class="hljs-number">11</span><span class="hljs-string">:47.529(-10)?</span>     <span class="hljs-string">✓</span> <span class="hljs-string">Define</span> <span class="hljs-string">Method</span> <span class="hljs-string">(103ms)</span>
<span class="hljs-attr">I20180522-16:</span><span class="hljs-number">11</span><span class="hljs-string">:47.540(-10)?</span>     <span class="hljs-string">✓</span> <span class="hljs-string">Update</span> <span class="hljs-string">Method</span>
<span class="hljs-attr">I20180522-16:</span><span class="hljs-number">11</span><span class="hljs-string">:47.558(-10)?</span>     <span class="hljs-string">✓</span> <span class="hljs-string">Remove</span> <span class="hljs-string">Method</span>
<span class="hljs-attr">I20180522-16:</span><span class="hljs-number">11</span><span class="hljs-string">:47.559(-10)?</span>
<span class="hljs-attr">I20180522-16:</span><span class="hljs-number">11</span><span class="hljs-string">:47.559(-10)?</span>
<span class="hljs-attr">I20180522-16:</span><span class="hljs-number">11</span><span class="hljs-string">:47.560(-10)?</span>   <span class="hljs-number">4</span> <span class="hljs-string">passing</span> <span class="hljs-string">(1s)</span>
<span class="hljs-attr">I20180522-16:</span><span class="hljs-number">11</span><span class="hljs-string">:47.560(-10)?</span>
<span class="hljs-attr">I20180522-16:</span><span class="hljs-number">11</span><span class="hljs-string">:47.608(-10)?</span> <span class="hljs-string">All</span> <span class="hljs-string">tests</span> <span class="hljs-string">finished!</span>
<span class="hljs-attr">I20180522-16:</span><span class="hljs-number">11</span><span class="hljs-string">:47.609(-10)?</span>
<span class="hljs-attr">I20180522-16:</span><span class="hljs-number">11</span><span class="hljs-string">:47.609(-10)?</span> <span class="hljs-bullet">--------------------------------</span>
<span class="hljs-attr">I20180522-16:</span><span class="hljs-number">11</span><span class="hljs-string">:47.609(-10)?</span> <span class="hljs-string">APP</span> <span class="hljs-string">SERVER</span> <span class="hljs-attr">FAILURES:</span> <span class="hljs-number">0</span>
<span class="hljs-attr">I20180522-16:</span><span class="hljs-number">11</span><span class="hljs-string">:47.609(-10)?</span> <span class="hljs-string">APP</span> <span class="hljs-string">CLIENT</span> <span class="hljs-attr">FAILURES:</span> <span class="hljs-number">0</span>
<span class="hljs-attr">I20180522-16:</span><span class="hljs-number">11</span><span class="hljs-string">:47.610(-10)?</span> <span class="hljs-bullet">--------------------------------</span>
</code></pre>
<p>As you can see, in contrast to unit tests, in which only server-side tests are run, only client-side tests are invoked in &quot;app-test&quot; mode.</p>
<h3><a class="anchor" aria-hidden="true" id="meteor-npm-run-test-all"></a><a href="#meteor-npm-run-test-all" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>meteor npm run test-all</h3>
<p>It is a good idea to run all of the tests (i.e. coding standards, data model, and meteor methods) in the following situations:</p>
<ul>
<li><p>Whenever you update your branch from master (to make sure the update has not introduced bugs into your branch)</p></li>
<li><p>Before you merge your changes from your branch into master (to make sure you are not introducing bugs into master)</p></li>
</ul>
<p>You could invoke the three types of tests individually, but it's easier to run the test-all script which will invoke them all for you with one command:</p>
<pre><code class="hljs">meteor npm <span class="hljs-keyword">run</span><span class="bash"> <span class="hljs-built_in">test</span>-all</span>
</code></pre>
<h3><a class="anchor" aria-hidden="true" id="continuous-integration"></a><a href="#continuous-integration" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Continuous Integration</h3>
<p>Finally, we have set up continuous integration for OPQ View with <a href="https://semaphoreci.com/">Semaphore CI</a>. The CI process is set up so that each time there is a commit to the master branch of the OPQ repository, the sources are checked out to Semaphore, and ESLint, data model unit tests, and full app Meteor method integration tests are run.  The results are reported to the #github channel in the OPQ Slack workspace.</p>
<p>Consult the <a href="https://semaphoreci.com/openpowerquality/opq/">Semaphore CI OPQ workspace</a> for more details.</p>
<h2><a class="anchor" aria-hidden="true" id="docker"></a><a href="#docker" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Docker</h2>
<p>Please see <a href="cloud-docker.html">Building, Publishing, and Deploying OPQ Cloud Services with Docker</a> for information on packaging up this service using Docker.</p>
</span></div></article></div><div class="docs-prevnext"><a class="docs-prev button" href="/docs/cloud-datamodel.html"><span class="arrow-prev">← </span><span>Data Model</span></a><a class="docs-next button" href="/docs/cloud-mauka.html"><span>Mauka</span><span class="arrow-next"> →</span></a></div></div></div><nav class="onPageNav"><ul class="toc-headings"><li><a href="#installation">Installation</a><ul class="toc-headings"><li><a href="#install-meteor">Install Meteor</a></li><li><a href="#install-libraries">Install libraries</a></li><li><a href="#configuration-viewconfigjson">Configuration (view.config.json)</a></li><li><a href="#additional-configuration-for-development-viewconfigjson">Additional configuration for development (view.config.json)</a></li><li><a href="#use-snapshot-db-optional">Use snapshot DB (optional)</a></li><li><a href="#use-production-db-optional">Use production DB (optional)</a></li><li><a href="#run-opqview">Run OPQView</a></li></ul></li><li><a href="#development-environment">Development Environment</a><ul class="toc-headings"><li><a href="#meteor">Meteor</a></li><li><a href="#intellij-idea">IntelliJ IDEA</a></li><li><a href="#eslint">ESLint</a></li><li><a href="#react">React</a></li><li><a href="#uniforms">Uniforms</a></li><li><a href="#react-time-series-charts">React Time Series Charts</a></li></ul></li><li><a href="#quality-assurance">Quality Assurance</a><ul class="toc-headings"><li><a href="#coding-standards">Coding standards</a></li><li><a href="#data-model-testing">Data model testing</a></li><li><a href="#meteor-method-testing">Meteor Method testing</a></li><li><a href="#meteor-npm-run-test-all">meteor npm run test-all</a></li><li><a href="#continuous-integration">Continuous Integration</a></li></ul></li><li><a href="#docker">Docker</a></li></ul></nav></div><footer class="nav-footer" id="footer"><section class="sitemap"><a href="/" class="nav-home"><img src="/img/opqlogo_white.png" alt="Open Power Quality" width="66" height="58"/></a><div><h5>Documentation Quick Links</h5><a href="/docs/intro-opq.html">Overview</a><a href="/docs/userguide-hardware.html">OPQ Box User Guide</a><a href="/docs/userguide-software.html">OPQ View User Guide</a><a href="/docs/other-agile-power-monitoring.html">Agile Power Monitoring for UH</a><a href="/docs/other-roadmap.html">Roadmap</a></div><div><h5>Community</h5><a href="https://openpowerquality.slack.com/" target="_blank" rel="noreferrer noopener">Slack</a><a href="https://twitter.com/opquality" target="_blank" rel="noreferrer noopener">Twitter</a><a href="/blog">News</a><a href="https://ics02.colo.hawaii.edu/">Public OPQ Cloud</a><a href="/contact-us.html">Contact Us</a></div><div><h5>Development</h5><a href="https://github.com/openpowerquality">GitHub</a><a href="https://github.com/openpowerquality/opq/projects">Project Boards</a><a href="/team.html">Developer Team</a><a href="/docs/opportunities.html">Opportunities</a></div></section><p style="text-align:center;color:#e9faff">Open Power Quality is sponsored by:<br/><a style="text-align:center;color:#e9faff" href="http://csdl.ics.hawaii.edu">Collaborative Software Development Laboratory, University of Hawaii</a><br/><a style="text-align:center;color:#e9faff" href="http://www.ics.hawaii.edu">Department of Information and Computer Sciences, University of Hawaii</a><br/><a style="text-align:center;color:#e9faff" href="http://ee.hawaii.edu">Department of Electrical Engineering, University of Hawaii</a><br/></p></footer></div><script type="text/javascript" src="https://cdn.jsdelivr.net/docsearch.js/1/docsearch.min.js"></script><script>
                document.addEventListener('keyup', function(e) {
                  if (e.target !== document.body) {
                    return;
                  }
                  // keyCode for '/' (slash)
                  if (e.keyCode === 191) {
                    const search = document.getElementById('search_input_react');
                    search && search.focus();
                  }
                });
              </script><script>
              var search = docsearch({
                
                apiKey: '9bf16cc78135dbeeb3826894ebbbb2ee',
                indexName: 'openpowerquality',
                inputSelector: '#search_input_react'
              });
            </script></body></html>